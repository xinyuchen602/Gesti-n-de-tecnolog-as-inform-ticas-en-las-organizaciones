"use strict";(()=>{var e={};e.id=390,e.ids=[390],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},879:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>v,originalPathname:()=>T,patchFetch:()=>R,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>E,staticGenerationBailout:()=>A});var o={};r.r(o),r.d(o,{POST:()=>d,dynamic:()=>u});var s=r(5419),a=r(9108),n=r(9678),i=r(4386),c=r(8070);let u="force-dynamic";async function d(e,{params:t}){try{await (0,i.I)();let e=await (0,i.V)(),r=await e.query("SELECT * FROM contestants WHERE id = $1",[t.id]);if(0===r.rows.length)throw Error("Contestant is already out of contest");return await e.query("UPDATE contestants SET votes = array_append(votes, $1) WHERE id = $2",[new Date,t.id]),e.release(),c.Z.json({message:"Vote registered correctly"})}catch(e){return console.error(e),c.Z.json({message:"Something went wrong"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/votes/[id]/route",pathname:"/api/votes/[id]",filename:"route",bundlePath:"app/api/votes/[id]/route"},resolvedPagePath:"C:\\Users\\xinyu\\Desktop\\Gestion-de-tecnologias-informaticas-en-las-organizaciones\\gestecord\\app\\api\\votes\\[id]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:E,serverHooks:g,headerHooks:v,staticGenerationBailout:A}=p,T="/api/votes/[id]/route";function R(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:E})}},4386:(e,t,r)=>{r.d(t,{V:()=>n,I:()=>i});let o=require("pg");var s=r(4790);r.n(s)().config();let a=new o.Pool({user:process.env.DB_USER,host:process.env.DB_HOST,database:process.env.DB_NAME||"kong",password:process.env.DB_PASSWORD,port:5432});async function n(){return await a.connect()}async function i(){try{let e=await n(),t=`
      CREATE TABLE IF NOT EXISTS contestants (
        id SERIAL PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        surname VARCHAR(255) NOT NULL,
        gender VARCHAR(20) NOT NULL,
        votes JSONB NOT NULL DEFAULT '[]',
        createdAt TIMESTAMP NOT NULL DEFAULT NOW()
      )
    `;await e.query(t),console.log('Table "contestants" created successfully.')}catch(e){throw console.error("Error initializing contestants table:",e),Error("Error initializing contestants table")}}console.log(process.env.DB_PASSWORD)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,166],()=>r(879));module.exports=o})();